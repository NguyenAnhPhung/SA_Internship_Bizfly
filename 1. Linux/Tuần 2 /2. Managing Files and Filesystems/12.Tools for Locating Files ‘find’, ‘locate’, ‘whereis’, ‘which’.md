# Tools for Locating Files: ‘find’, ‘locate’, ‘whereis’, ‘which’

tham khảo tại [lpi.org](https://learning.lpi.org/en/learning-materials/101-500/104/104.7/104.7_01/)

## 1. Find - tìm kiếm tệp

`find` dùng để tìm kiếm tệp trên linux 

Theo mặc định, `find` sẽ bắt đầu ở điểm bắt đầu và đi xuống bất kỳ một thư mục con nào (và các thư mục con của các thư mục con đó) được tìm thấy. Ta có thể hạn chế hành vi này bằng tham số 

`maxdeep N` : độ sâu tối đa mà find tìm kiếm 

`mindeep N`: độ sâu tối thiểu 

```
directory
├── clients.txt
├── partners.txt -> clients.txt
└── somedir
    ├── anotherdir
    └── clients.txt
```

với directory tương ứng với bậc 1

ví dụ:

```
find . -maxdeep 3 -name '*.txt*'
```

**Cấu trúc cơ bản của lệnh find**

```
find [đường dẫn] [tùy chọn] [thao tác]
```

**ví dụ**

#### `-name` tìm kiếm theo tên tệp

- Tìm kiếm tệp theo tên cụ thể

```
find . -name 'file.txt'
```

- Tìm kiếm tệp theo chuỗi 'file' , dùng 2 * để thay thế

```
find . -name '*file*'
```

- Tìm kiếm không phân biệt chữ hoa chữ thường thêm tùy chọn `-i` 

```
find . -iname 'file.txt'
```

#### `-type` tìm kiếm theo loại 

- Tìm tệp thư mục 

  ```
  find . -type d
  ```

- Tìm tệp thông thường

  ```
  find . -type f
  ```

#### `-size` tìm kiếm tệp có kích thước nhất định 

- Tìm kiếm tệp có kích thước lớn hơn 1G

  ```
  find . -size +1G
  ```

- Tìm kiếm tệp có kích thước nhỏ hơn 100MB

  ```
  find . -size -100M
  ```

#### `-mtime` tìm kiếm tệp theo ngày thay đổi

- tệp **đã thay đổi** trong vòng 7  ngày qua

  ```
  find . -mtime -7
  ```

- tệp **không thay đổi** trong 30 ngày qua

  ```
  find . -mtime +30
  ```

#### Tìm kiếm theo thuộc tính

- ##### `-user USERNAME`

  So khớp các tệp thuộc sở hữu của người dùng `USERNAME`.

- ##### `-group GROUPNAME`

  So khớp các tệp thuộc sở hữu của nhóm `GROUPNAME`.

- ##### `-readable`

  So khớp các tệp mà người dùng hiện tại có thể đọc được.

- ##### `-writable`

  So khớp các tệp mà người dùng hiện tại có thể ghi.

- ##### `-executable`

  So khớp các tệp mà người dùng hiện tại có thể thực thi được. Đối với thư mục, tham số này sẽ khớp với bất kỳ thư mục nào mà người dùng có thể truy nhập (quyền `x`).

- ##### `-perm NNNN`

  Tham số này sẽ khớp với bất kỳ tệp nào có chính xác quyền `NNNN`. Ví dụ: `-perm 0664` sẽ khớp với bất kỳ tệp nào mà người dùng và nhóm có thể đọc và ghi và những tệp mà người khác có thể đọc (hoặc `rw-rw-r--`).

Chúng ta có thể thêm `-` vào trước `NNNN` để kiểm tra các tệp có *ít nhất* quyền được chỉ định. Ví dụ: `-perm -644` sẽ khớp với các tệp có ít nhất quyền `644` (`rw-r—r--`) - bao gồm một tệp có `664` (`rw-rw-r--`) hoặc thậm chí là `775` (`rwxrwx-r-x`).

ví dụ 

```
 find . -perm -600
```

#### Tìm kiếm theo thời gian 

Lệnh `find` với các tham số tìm kiếm theo thời gian giúp bạn tìm các tệp theo thời gian truy cập, thay đổi thuộc tính hoặc sửa đổi của chúng. Dưới đây là giải thích chi tiết về các tham số và ví dụ bạn đưa ra.

### Các tham số liên quan đến thời gian:
1. **`-amin N`**: Tìm các tệp đã được truy cập (accessed) trong vòng `N` phút.
2. **`-cmin N`**: Tìm các tệp mà thuộc tính (metadata) của chúng đã thay đổi trong vòng `N` phút. Sự thay đổi này có thể bao gồm thay đổi quyền truy cập, sửa đổi nội dung hoặc bất kỳ thao tác nào liên quan đến tệp.
3. **`-mmin N`**: Tìm các tệp đã bị sửa đổi nội dung (modified) trong vòng `N` phút.

### Các tham số thời gian theo ngày:
1. **`-atime N`**: Tìm các tệp đã được truy cập trong vòng `N` ngày. Nếu `N` là số dương, tìm các tệp truy cập đúng `N` ngày trước. Nếu `-N`, tìm các tệp đã truy cập trong vòng `N` ngày qua.
2. **`-ctime N`**: Tìm các tệp có thay đổi thuộc tính trong vòng `N` ngày. Nếu `N` là số dương, tìm các tệp thay đổi thuộc tính đúng `N` ngày trước. Nếu `-N`, tìm các tệp có thay đổi thuộc tính trong vòng `N` ngày qua.
3. **`-mtime N`**: Tìm các tệp đã bị sửa đổi trong vòng `N` ngày. Nếu `N` là số dương, tìm các tệp sửa đổi đúng `N` ngày trước. Nếu `-N`, tìm các tệp đã sửa đổi trong vòng `N` ngày qua.

Giải thích ví dụ:

```
$ find . -mtime -1 -size +100M
```
- **`find .`**: Tìm kiếm trong thư mục hiện tại (`.` là ký hiệu cho thư mục hiện tại).
- **`-mtime -1`**: Tìm các tệp đã được **sửa đổi trong vòng 24 giờ qua**. Dấu `-` trước số `1` chỉ ra rằng chúng ta đang tìm kiếm các tệp đã bị sửa đổi **ít hơn 1 ngày trước** (tức là trong vòng 24 giờ qua).
- **`-size +100M`**: Tìm các tệp có **kích thước lớn hơn 100 MiB**.

Lệnh này sẽ tìm tất cả các tệp trong thư mục hiện tại mà đã được sửa đổi trong vòng 24 giờ qua và có kích thước lớn hơn 100 MiB. 

Tóm tắt:

- **`-mtime -1`**: Tìm tệp đã sửa đổi trong vòng 24 giờ qua.
- **`-size +100M`**: Tìm tệp có kích thước lớn hơn 100 MiB.

Kết quả là tất cả các tệp trong thư mục hiện tại thỏa mãn cả hai điều kiện này sẽ được liệt kê.