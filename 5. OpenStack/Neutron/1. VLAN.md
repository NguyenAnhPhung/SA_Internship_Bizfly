# VLAN & VxLAN

tham kháº£o táº¡i [vinahost](https://vinahost.vn/vlan-la-gi/)

## 1.Vlan

### 1.1. VLAN lÃ  gÃ¬?

ThÃ´ng thÆ°á»ng mÃ¡y tÃ­nh sáº½ káº¿t ná»‘i vá»›i nhau thÃ´ng qua hub-switch, váº¥n Ä‘á» Ä‘áº·t ra lÃ  náº¿u cÃ´ng ty cÃ³ nhiá»u phÃ²ng ban thÃ¬ sáº½ pháº£i sá»­ dá»¥ng Ä‘áº¿n nhiá»u bá»™ hub-switch. VÃ¬ váº­y, VLAN sinh ra Ä‘á»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y.

VLAN há»at Ä‘á»™ng báº±ng cÃ¡ch nhÃ³m cÃ¡c máº¡ng LAN khÃ¡c nhau vÃ o cÃ¹ng má»™t bá»™ hub - switch

### 1.2. CÃ¡ch thá»©c hoáº¡t Ä‘á»™ng cá»§a VLAN

Vá» cÆ¡ báº£n nÃ³ sáº½ chia máº¡ng váº­t lÃ­ thÃ nh cÃ¡c máº¡ng con áº£o Ä‘á»™c láº­p.

- **PhÃ¢n chia máº¡ng váº­t lÃ­:** VLAN báº¯t Ä‘áº§u báº±ng viá»‡c phÃ¢n chia cÃ¡c máº¡ng váº­t lÃ­ nhá» hÆ¡n gá»i lÃ  VLANs
- **GÃ¡n VLAN IDs:** Má»—i VLAN Ä‘Æ°á»£c gÃ¡n 1 VLAN ID. CÃ¡c thiáº¿t bá»‹ máº¡ng nhÆ° Switch sáº½ sá»­ dá»¥ng VLAN ID Ä‘á»ƒ xÃ¡c Ä‘á»‹nh cÃ¡c VLAN
- **GÃ¡n cá»•ng vÃ  cá»•ng trá»« tÆ°á»£ng:** Cá»•ng trÃªn Switch Ä‘Æ°á»£c gÃ¡n cho tá»«ng VLAN cá»¥ thá»ƒ. Cá»•ng nÃ y cÃ³ thá»ƒ lÃ  cá»•ng váº­t lÃ­ hoáº·c cá»•ng trá»«u tÆ°á»£ng. CÃ¡c thiáº¿t bá»‹ trÃªn cÃ¹ng 1 VLAN cÃ³ thá»ƒ giao tiáº¿p Ä‘Æ°á»£c vá»›i nhau vÃ  háº¡n cháº¿ giao tiáº¿p vá»›i cÃ¡c thiáº¿t bá»‹ á»Ÿ cÃ¡c VLAN khÃ¡c 

- **Access Ports vÃ  Trunk Ports:** TrÃªn lÃ  2 cá»•ng quan trá»ng, Access Port Ä‘Æ°á»£c gÃ¡n cho má»™t VLAN cá»¥ thá»ƒ, Trunk Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ chuyá»ƒn dá»¯ liá»‡u giá»¯a cÃ¡c Switch vÃ  giá»¯a cÃ¡c VLAN

  ![img](https://vinahost.vn/wp-content/uploads/2024/03/vlan-la-gi-1.jpg)

- Dá»¯ liá»‡u Ä‘i qua Trunk, thÃ´ng tin vá» VLAN ID thÆ°á»ng Ä‘Æ°á»£c thÃªm vÃ o gÃ³i tin. NgÆ°á»£c láº¡i dá»¯ liá»‡u rá»i khá»i VLAN thÃ¬ thÃ´ng tin nÃ y bá»‹ gá»¡ bá»
- **Táº¡o Broadcast Dmains**: Má»—i VLAN táº¡o ra 1 Broadcast Domain Ä‘á»™c láº­p

## 2. VxLAN

Trong mÃ´i trÆ°á»ng máº¡ng cá»¥c bá»™ má»Ÿ rá»™ng, sá»‘ lÆ°á»£ng ngÆ°á»i thuÃª Cloud ngÃ y cÃ ng tÄƒng, Ä‘Ã²i há»i kháº£ nÄƒng cÃ´ láº­p máº¡ng tá»‘t hÆ¡n giá»¯a cÃ¡c tenant. Tuy nhiÃªn, VLAN thÃ´ng thÆ°á»ng chá»‰ sá»­ dá»¥ng 12-bit VLAN ID, giá»›i háº¡n tá»‘i Ä‘a **4096 VLAN**, Ä‘iá»u nÃ y khÃ´ng Ä‘á»§ Ä‘Ã¡p á»©ng nhu cáº§u cá»§a cÃ¡c há»‡ thá»‘ng lá»›n.

VXLAN giáº£i quyáº¿t váº¥n Ä‘á» nÃ y báº±ng cÃ¡ch má»Ÿ rá»™ng sá»‘ lÆ°á»£ng máº¡ng áº£o lÃªn Ä‘áº¿n **16 triá»‡u** (sá»­ dá»¥ng 24-bit VXLAN Network Identifier - VNI). Trong mÃ´i trÆ°á»ng áº£o hÃ³a, nÆ¡i cÃ³ sá»‘ lÆ°á»£ng VM lá»›n vÃ  yÃªu cáº§u di chuyá»ƒn VM linh hoáº¡t giá»¯a cÃ¡c mÃ¡y chá»§ váº­t lÃ½, VXLAN vÆ°á»£t trá»™i hÆ¡n VLAN.

ğŸ”¹ **Váº¥n Ä‘á» vá»›i VLAN khi di chuyá»ƒn VM:**

- Khi VM di chuyá»ƒn tá»« **Server A** sang **Server B**, náº¿u Server B thuá»™c dáº£i máº¡ng khÃ¡c, Ä‘á»‹a chá»‰ IP cá»§a VM pháº£i thay Ä‘á»•i.
- Äiá»u nÃ y dáº«n Ä‘áº¿n **IP má»›i khÃ´ng khá»›p vá»›i Ä‘á»‹a chá»‰ MAC trÆ°á»›c Ä‘Ã³**, gÃ¢y máº¥t káº¿t ná»‘i hoáº·c yÃªu cáº§u cáº¥u hÃ¬nh láº¡i.

ğŸ”¹ **CÃ¡ch VXLAN giáº£i quyáº¿t váº¥n Ä‘á»:**

- VXLAN **bá»c toÃ n bá»™ khung Ethernet (L2)** vÃ o trong má»™t gÃ³i tin UDP/IP vÃ  truyá»n qua máº¡ng Layer 3.
- Viá»‡c **Ä‘Ã³ng gÃ³i vÃ  giáº£i nÃ©n** Ä‘Æ°á»£c thá»±c hiá»‡n bá»Ÿi **VXLAN Tunnel End Point (VTEP)** trÃªn cÃ¡c mÃ¡y chá»§.
- Khi gÃ³i tin Ä‘áº¿n Server B, nÃ³ Ä‘Æ°á»£c giáº£i nÃ©n trá»Ÿ láº¡i Layer 2, **giá»¯ nguyÃªn Ä‘á»‹a chá»‰ MAC vÃ  IP cá»§a VM**.
- Äiá»u nÃ y giÃºp **VM duy trÃ¬ káº¿t ná»‘i nhÆ° thá»ƒ váº«n náº±m trong cÃ¹ng má»™t máº¡ng Layer 2**, ngay cáº£ khi thá»±c táº¿ Ä‘Ã£ di chuyá»ƒn qua nhiá»u máº¡ng váº­t lÃ½ khÃ¡c nhau.

â© **Káº¿t luáº­n:** VLAN khÃ´ng phÃ¹ há»£p cho cÃ¡c há»‡ thá»‘ng Cloud lá»›n do giá»›i háº¡n sá»‘ lÆ°á»£ng vÃ  kháº£ nÄƒng má»Ÿ rá»™ng. VXLAN giÃºp má»Ÿ rá»™ng máº¡ng áº£o, há»— trá»£ di chuyá»ƒn VM linh hoáº¡t mÃ  khÃ´ng thay Ä‘á»•i IP, phÃ¹ há»£p cho cÃ¡c há»‡ thá»‘ng hiá»‡n Ä‘áº¡i. ğŸš€

